import { Field, ObjectType } from '@nestjs/graphql';

import SecurityAdvisory from './securityAdvisory';
import SecurityAdvisoryPackageVersion from './securityAdvisoryPackageVersion';
import SecurityAdvisoryPackage from './securityAdvisoryPackage';
import { SecurityAdvisorySeverity } from './securityAdvisorySeverity';

@ObjectType()
export default class SecurityVulnerability {
  @Field(() => String, {
    nullable: false,
    description: 'When the vulnerability was last updated',
  })
  updatedAt: string;

  @Field(() => SecurityAdvisory, {
    nullable: false,
    description: 'The Advisory associated with this Vulnerability',
  })
  advisory: SecurityAdvisory;

  @Field(() => SecurityAdvisoryPackageVersion, {
    nullable: true,
    description: 'When was the alert dimissed?',
  })
  firstPatchedVersion: SecurityAdvisoryPackageVersion;

  @Field(() => SecurityAdvisoryPackage, {
    nullable: true,
    description: 'The user who dismissed the alert',
  })
  package: SecurityAdvisoryPackage;

  @Field(() => SecurityAdvisorySeverity, {
    nullable: true,
    description: 'The severity of the vulnerability within this package',
  })
  severity: SecurityAdvisorySeverity;

  @Field(() => String, {
    nullable: false,
    description: 'A string that describes the vulnerable package versions.',
  })
  vulnerableVersionRange: string;
}
